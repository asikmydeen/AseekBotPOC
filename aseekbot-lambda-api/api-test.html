<!DOCTYPE html>
<html>
<head>
    <title>API Test Page</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .test-section { margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        button { padding: 8px 16px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer; }
        textarea { width: 100%; height: 100px; margin: 10px 0; }
        .response { background: #f5f5f5; padding: 10px; border-radius: 4px; white-space: pre-wrap; }
        input[type="file"] { margin: 10px 0; }
        input[type="text"] { padding: 8px; width: 100%; margin: 5px 0; }
    </style>
</head>
<body>
    <h1>API Test Page</h1>

    <div class="test-section">
        <h2>Test Quick Link</h2>
        <textarea id="quickLinkPayload">{"action": "getHelp"}</textarea>
        <button onclick="testQuickLink()">Test Quick Link</button>
        <div id="quickLinkResponse" class="response"></div>
    </div>

    <div class="test-section">
        <h2>Test Create Ticket</h2>
        <input type="text" id="ticketTitle" placeholder="Ticket Title" value="Test Ticket">
        <textarea id="ticketDescription" placeholder="Ticket Description">This is a test ticket description.</textarea>
        <input type="text" id="ticketEmail" placeholder="Email" value="test@example.com">
        <button onclick="testCreateTicket()">Create Ticket</button>
        <div id="createTicketResponse" class="response"></div>
    </div>

    <div class="test-section">
        <h2>Test Process Chat Message</h2>
        <textarea id="chatMessage" placeholder="Enter your message">Hello, how can you help me?</textarea>
        <input type="text" id="sessionId" placeholder="Session ID" value="test-session-123">
        <button onclick="testProcessChatMessage()">Send Message</button>
        <div id="processChatResponse" class="response"></div>
    </div>

    <div class="test-section">
        <h2>Test Upload File</h2>
        <input type="file" id="fileUpload">
        <input type="text" id="uploadSessionId" placeholder="Session ID" value="test-session-123">
        <button onclick="testUploadFile()">Upload File</button>
        <div id="uploadFileResponse" class="response"></div>
    </div>

    <script>
        const API_BASE_URL = 'https://c9mue0raqh.execute-api.us-east-1.amazonaws.com/dev/api';

        function displayResponse(elementId, data) {
            document.getElementById(elementId).textContent = typeof data === 'object'
                ? JSON.stringify(data, null, 2)
                : data;
        }

        async function testQuickLink() {
            try {
                const payload = JSON.parse(document.getElementById('quickLinkPayload').value);
                const response = await fetch(`${API_BASE_URL}/quickLink`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });
                const data = await response.json();
                displayResponse('quickLinkResponse', data);
            } catch (error) {
                displayResponse('quickLinkResponse', `Error: ${error.message}`);
            }
        }

        async function testCreateTicket() {
            try {
                const payload = {
                    title: document.getElementById('ticketTitle').value,
                    description: document.getElementById('ticketDescription').value,
                    email: document.getElementById('ticketEmail').value
                };
                const response = await fetch(`${API_BASE_URL}/createTicket`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });
                const data = await response.json();
                displayResponse('createTicketResponse', data);
            } catch (error) {
                displayResponse('createTicketResponse', `Error: ${error.message}`);
            }
        }

        async function testProcessChatMessage() {
            try {
                const message = document.getElementById('chatMessage').value;
                const sessionId = document.getElementById('sessionId').value;

                const formData = new FormData();
                formData.append('message', message);
                formData.append('sessionId', sessionId);

                const response = await fetch(`${API_BASE_URL}/processChatMessage`, {
                    method: 'POST',
                    body: formData
                });
                const data = await response.json();
                displayResponse('processChatResponse', data);
            } catch (error) {
                displayResponse('processChatResponse', `Error: ${error.message}`);
            }
        }

        async function testUploadFile() {
            try {
                const fileInput = document.getElementById('fileUpload');
                if (!fileInput.files.length) {
                    throw new Error('Please select a file');
                }

                const file = fileInput.files[0];
                const sessionId = document.getElementById('uploadSessionId').value;

                const formData = new FormData();
                formData.append('file', file);
                formData.append('sessionId', sessionId);

                const response = await fetch(`${API_BASE_URL}/uploadFile`, {
                    method: 'POST',
                    body: formData
                });
                const data = await response.json();
                displayResponse('uploadFileResponse', data);
            } catch (error) {
                displayResponse('uploadFileResponse', `Error: ${error.message}`);
            }
        }
    </script>
</body>
</html>